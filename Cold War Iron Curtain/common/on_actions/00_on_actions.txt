on_actions = {
	on_monthly = {
		effect = {
			monthly_education_pulse = yes
			#gdp_calculation_effect = yes
			if = {
				limit = {
					is_ai = no
				}
				GDP_Graph_Financial_Tab_Update = yes
				GDP_Debt_Graph_Financial_Tab_Update = yes
				Food_Graph_Financial_Tab_Update = yes
				Income_Graph_Financial_Tab_Update = yes
				Electricity_Graph_Financial_Tab_Update = yes
			}
			add_to_variable = {
				Current_Month = 1
			}
			add_to_variable = {
				month_counter = 1
			}
			if = {	#Reset to January after December
				limit = {
					check_variable = {
						Current_Month > 12
					}
				}
				set_variable = {
					Current_Month = 1
				}
				#GDP YOY
				set_variable = {
					yoy_change_gdp = grossdomesticproduct
				}
				subtract_from_variable = {
					yoy_change_gdp = last_year_gdp
				}
				set_variable = {
					last_year_gdp = grossdomesticproduct
				}
				#GDP-Debt YOY
				set_variable = {
					yoy_change_debt = GDP_Debt_Ratio
				}
				subtract_from_variable = {
					yoy_change_debt = last_year_debt
				}
				set_variable = {
					last_year_debt = GDP_Debt_Ratio
				}
				#Food YOY
				set_variable = {
					yoy_change_food = FoodBalanceTotal
				}
				subtract_from_variable = {
					yoy_change_food = last_year_food
				}
				set_variable = {
					last_year_food = FoodBalanceTotal
				}
				#Electricity YOY
				set_variable = {
					yoy_change_electricty = resource@electricity
				}
				subtract_from_variable = {
					yoy_change_electricty = last_year_electricty
				}
				set_variable = {
					last_year_electricty = resource@electricity
				}
				#Balance YOY
				set_variable = {
					yoy_change_balance = IncomeCheck
				}
				subtract_from_variable = {
					yoy_change_balance = last_year_balance
				}
				set_variable = {
					last_year_balance = IncomeCheck
				}
			}
			add_to_array = {
				Month_Label = Current_Month
			}
			if = {	#keeps in balance
				limit = {
					check_variable = { month_counter > 20 }
				}
				remove_from_array = { array = Month_Label index = 0 }
			}

			#ENG = {
			#	calculate_div_limit = yes
			#	if = {
			#		limit = {
			#			has_completed_focus = UK_60s_Amalgamate_Our_Regiments
			#			check_variable = { div_limit < num_divisions }
			#		}
			#		add_ideas = ENG_div_limit_exceededz
			#		country_event = ENG_event.23
			#	}
			#}
		}
	}
	# country 
	on_new_term_election = {
		random_events = {
			100 = usa.1002
			100 = usa.19603
			100 = usa.19563
			100 = usa.19643
			100 = usa.19683
			100 = usa.19723
			100 = usa.19763
			100 = usa.19803
			100 = usa.19843
			100 = usa.19883
			100 = usa.19923
			100 = usa.19963
			100 = usa.20003
			100 = usa.20043
			100 = usa.20083
			100 = usa.20123
			100 = usa.20163
		}
		random_events = {
			100 = Canada_Elections.1
			100 = Canada_Elections.2
			100 = Canada_Elections.3
			100 = Canada_Elections.4
		}
		random_events = {
			100 = cw_saf.20
			100 = cw_saf.1
		}
		random_events = {
			100 = India_Elections.1
			100 = India_Elections.2
			100 = India_Elections.3
			100 = India_Elections.4
			100 = India_Elections.5
			100 = India_Elections.6
		}
		random_events = {
			100 = election.1
		}
		random_events = {
			100 = mex.1
			100 = mex.2
		}
		random_events = {
			100 = ita.200
			100 = ita.250
			100 = ita.201
		}
		random_events = {
			100 = por.1
			100 = por.2
		}
		random_events = {
			100 = fin.200
			100 = fin.201
			100 = fin.202
			100 = fin.203
			100 = fin.204
			100 = fin.205
			100 = fin.206
		}
		random_events = {
			100 = cw_saf.1
			100 = cw_saf.20
			100 = saf_elections.1
			100 = saf_elections.2
			100 = saf_elections.3
		}
		#random_events = {
		#	100 = SWE_Elections.1
		#	100 = SWE_Elections.2
		#	100 = SWE_Elections.3
		#	100 = SWE_Elections.4
		#	100 = SWE_Elections.5
		#	100 = SWE_Elections.6
		#	100 = SWE_Elections.7
		#	100 = SWE_Elections.8
		#	100 = SWE_Elections.9
		#	100 = SWE_Elections.10
		#}
		random_events = {
			100 = rho.1
			100 = rho.104
			100 = rho.126
			100 = rho.127
			100 = rho.128
		}
		random_events = {
			100 = cuba.25
		}
		random_events = {
			100 = iree.1
			100 = iree.2
			100 = iree.3
		}
		random_events = {
			100 = swi_elections.1
			100 = swi_elections.2
			100 = swi_elections.3
			100 = swi_elections.4
		}
		random_events = {
			100 = BEL49_Election.0
			100 = BEL50_Election.0
			100 = BEL54_Election.0
			100 = BEL58_Election.0
		}
		random_events = {	#Korea
			100 = KOR_election.1952
			100 = KOR_election.1956
			100 = KOR_election.1960
			100 = KOR_election.1963
			100 = KOR_election.1967
			100 = KOR_election.1971
			100 = KOR_election.1972
			100 = KOR_election.1978
			100 = KOR_election.1979
			100 = KOR_election.1980
			100 = KOR_election.1981
			100 = KOR_election.1987
			100 = KOR_election.1992
			100 = KOR_election_97prepare.1
			100 = KOR_election.02prepare.1
			100 = KOR_election.07prepare.1
		}
	}
	
	# During justifying wargoals
	# triggered daily, so make sure there is a sink somewhere not firing events
	# country, FROM = target nation
	on_justifying_wargoal_pulse = {
		random_events = {
			1000 = NATO.1
		}
		random_events = {
			100 = war_justification.1
			100 = war_justification.2
			100 = war_justification.3
			100 = war_justification.4
			100 = war_justification.5
			100 = war_justification.6
			100 = war_justification.7
			100 = war_justification.8
			100 = war_justification.9
			100 = war_justification.10
			100 = war_justification.11
			100 = war_justification.12
			100 = war_justification.13
			100 = war_justification.14
			100 = war_justification.15
			100 = war_justification.16
			100 = war_justification.17
			100 = war_justification.18
			100 = war_justification.19
			17000 = 0
		}
	}
	on_wargoal_expire = {
		random_events = {
			100 = war_justification.301
		}
	}
	on_leave_faction = {
		effect = {
			if = {
				limit = {
					NOT = {
						FROM = {
							original_tag = VIE
						}
					}
				}
				FROM = {
					add_opinion_modifier = {
						modifier = faction_traitor
						target = ROOT
						days = 365
					}
				
					add_opinion_modifier = {
						modifier = faction_traitor_trade
						target = ROOT
						days = 365
					}
				}
			}
			if = {
				limit = {
					FROM = {
						has_idea = nato_member
					}
				}
				remove_ideas = nato_member
			}
		}
	}

	#FROM is faction leader on join faction requests.
	on_join_faction = {
		effect = {
			if = {
				limit = {
					FROM = {
						has_idea = nato_member
					}
				}
				add_ideas = nato_member
			}
		}
	}
	on_release_as_puppet = {
		effect = {
			if = {
				limit = {
					ROOT = { tag = YUG }
					FROM = { tag = SOV }
				}
				remove_ideas = YUG_anti_soviet
				set_politics = {
					ruling_party = trotskyism #dont change this at all!! it will play into YUG 60s Content. Under agreement with Stalin, Tito gets to stay in power and do whatever he wants as long as he allows soviet troops in the country and back up the USSR diplomatically.
				}
				add_popularity = {
					ideology = trotskyism
					popularity = 0.6
				}
				add_popularity = {
					ideology = communism
					popularity = 0.4
				}
			}
		}
	}
	# ROOT is attacker, FROM is defender
	on_declare_war = {
		effect = {
			if = {
				limit = {
					OR = {
						AND = {
							ROOT = { tag = SOV }
							FROM = { tag = PRC }
						}
						AND = {
							ROOT = { tag = PRC }
							FROM = { tag = SOV }
						}
					}
				}
				Sino_Soviet_War = yes
			}
			hidden_effect = {
				# Remove Influence modifiers if any
				FROM = { country_event = influence.10 }
			}
			# Check for attack on NATO Member
			if = {
				limit = {
					OR = {
						# Attacked a NATO member
						FROM = { has_idea = nato_member }
						# Attacked a puppet of a NATO member
						FROM = {
							is_subject = yes
							OVERLORD = { has_idea = nato_member }
							has_civil_war = no # check if this is a NATO puppet's civil war
							NOT = { original_tag = VIE } # prevents VIE from calling FRA into their shenanigans
						}
					}
				}
				custom_effect_tooltip = TT_CALL_NATO
				if = { limit = { NOT = { has_global_flag = NATO_called_to_arms } }
					FROM = { country_event = NATO.2 }
				}
				set_country_flag = Attacked_NATO
				# if a NATO member attacks another NATO member, kick him from NATO
				if = {
					limit = {
						has_idea = nato_member
						OR = {
							FROM = { has_idea = nato_member }
							FROM = {
								is_subject = yes
								OVERLORD = { has_idea = nato_member }
							}
						}
					}
					custom_effect_tooltip = TT_CALL_NATO
					FROM = { country_event = NATO.20 }
					remove_ideas = nato_member
				}
			}
		}
	}
	
	# When a new faction is formed
	on_faction_formed = {
		effect = {
			news_event = news.159
		}
	}

	#FROM is the state nuked
	on_nuke_drop = {
		effect = {
			if = { 
				limit = {
					FROM = {
						is_core_of = USA 
					}
					USA = {
						has_country_flag = SDI_suceed
					}
				} 
				#news_event SDI sucessful shootdown	
			}
			if = {
				limit = {
					NOT = {
						has_global_flag = wmd_first_nuke
					} 
				} #First Nuke
				set_global_flag = wmd_first_nuke
				news_event = nuke_dropped.1
			}
			if = { 
				limit = { 
					FROM = {
						state = 529 
					} 
					NOT = { 
						has_global_flag = hiroshima_nuked 
					} 
				} 
				news_event = nuke_dropped.2
			} #Hiroshima
			else_if = { limit = { FROM = { state = 528 } NOT = { has_global_flag = nagasaki_nuked } } news_event = nuke_dropped.3 } #Nagasaki
			else_if = { limit = { FROM = { state = 742 } NOT = { has_global_flag = berlin_nuked } } news_event = nuke_dropped.4 } #West Berlin
			else_if = { limit = { FROM = { state = 744 } NOT = { has_global_flag = berlin_nuked } } news_event = nuke_dropped.4 } #East Berlin
			else_if = { limit = { FROM = { state = 126 } NOT = { has_global_flag = london_nuked } } news_event = nuke_dropped.5 } #London
			else_if = { limit = { FROM = { state = 531 } NOT = { has_global_flag = kyoto_nuked } } news_event = nuke_dropped.6 } #Kyoto
			else_if = { limit = { FROM = { state = 282 } NOT = { has_global_flag = tokyo_nuked } } news_event = nuke_dropped.7 } #Tokyo
			else_if = { limit = { FROM = { state = 1200 } NOT = { has_global_flag = washington_nuked } } news_event = nuke_dropped.8 } #Washington
			else_if = { limit = { FROM = { state = 2 } NOT = { has_global_flag = rome_nuked } } news_event = nuke_dropped.9 } #Rome
			else_if = { limit = { FROM = { state = 16 } NOT = { has_global_flag = paris_nuked } } news_event = nuke_dropped.10 } #Paris
			else_if = { limit = { FROM = { state = 219 } NOT = { has_global_flag = moscow_nuked } } news_event = nuke_dropped.11 } #Moscow
			else_if = { limit = { FROM = { state = 37 } NOT = { has_global_flag = copenhagen_nuked } } news_event = nuke_dropped.12 } #Copenhagen
			else_if = { limit = { FROM = { state = 141 } NOT = { has_global_flag = stockholm_nuked } } news_event = nuke_dropped.13 } #Stockholm
			wmd_damage_loop_effect = yes
		}

		random_events = {
			# 100 = nuke_dropped.0
			# 10000 = nuke_dropped.100
		}
	}
}