scripted_gui = {
	national_ideas_menu = {
		window_name = "show_national_ideas"

		context_type = player_context
		visible = {
			check_variable = {
				show_national_ideas = 1
			}
		}		
		effects = {
			close_button_click = {
				set_variable = {
					show_national_ideas = 0
				}
			}
		}
	}
	national_ideas_list = {
        context_type = player_context
        window_name = "national_ideas_list"
		parent_scripted_gui = national_ideas_menu
        dynamic_lists = {
            national_ideas_list_grid = {
                array = ROOT.current_idea_list
				entry_container = national_ideas_list_entry
            }
        }
		effects = {
			national_ideas_list_entry_right_click = { 
				meta_effect = { text = { show_ideas_tooltip = [IDEA_TOKEN] } IDEA_TOKEN = "[?v.GetTokenKey]" }
				if = {
					limit = { has_variable = THIS.idea_date_@var:v }
					
					set_temp_variable = { idea_expiry = THIS.idea_date_@var:v } # Start at the start num_days of the timed idea
					add_to_temp_variable = { idea_expiry = THIS.idea_len_@var:v } # Find the end num_days of the timed idea
					set_temp_variable = { temp_days = idea_expiry }
					subtract_from_temp_variable = { temp_days = global.num_days } # Subtract today's num_days to find how many days are left
					
					# This isn't for catching expired timed ideas, those would not show up in the array on account of having expired, 
					# it's actually in case an idea is added as timed and then later re-added as permanent. Stupid edge case which will probably never happen!
					
					if = {
						limit = { NOT = { check_variable = { temp_days < 0 } } } 
						
						custom_effect_tooltip = timed_idea_expiry_tip
					} 
					else_if = {
						limit = { NOT = { check_variable = { idea_expiry < last_refresh_date } } }
						
						custom_effect_tooltip = timed_idea_just_expired_tip
					}   
				}
				meta_effect = {
					text = {
						set_temp_variable = { desc_token = token:[IDEA_TOKEN]_description }
					}
					IDEA_TOKEN = "[?v.GetTokenKey]"
				}
				custom_effect_tooltip = idea_description_tip
			}
		}
	}
	japan_diet_window = {
		window_name = "parliament_window_jap_container"
 
		context_type = player_context
		parent_window_token = politics_tab
		visible = {
			#tag = JAP
			always = no
		}		
	}
	legislation_menu_button = {
        context_type = player_context
        window_name = "legislation_menu_button"
		parent_window_token = politics_tab
        dynamic_lists = {
            legislation_menu_button_grid = {
                array = ROOT.country_politics_list
				entry_container = legislation_menu_button_list_entry
            }
        }
		effects = {
			policy_switch_click = { 
				set_variable = { root.show_resolution = 0 }
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 1 }
					}
					set_variable = { policy_legislation = 1 }
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 26 }
						has_country_flag = activate_sect_menu
					}
					set_variable = {
						show_vie_sect_gui = 1
					}
					vietnam_sect_conditions_met_check = yes
					vietnam_faction_ui_update_number = yes
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 25 }
					}
					set_temp_variable = { show = 1 }
					subtract_from_temp_variable = { show = show_arab_league_main }
					close_all_windows = yes
					set_variable = { show_arab_league_main = show }
								
					if = {
						#limit = { has_variable = show_arab_league_main }
						limit = { check_variable = { show > 0 } }
						add_to_variable = { QAT.main_screen = 0 }					
						#clear_variable = show_arab_league_main
						set_variable = { QAT.country_visible = 0 }
						set_variable = { show_tutorial_menu = 0 }
					}
					else = {
						set_variable = { root.arab_league_action_set = -1 }				#set res selection to default
						set_variable = { root.arab_league_influence_action_set = -1 } 	#set inf selection to default
						#set_variable = { show_arab_league_main = 1 }
						add_to_variable = { QAT.main_screen = 0 }
						set_variable = { QAT.country_visible = 0 }
						set_variable = { show_tutorial_menu = 0 }
					}

					if = {
						limit = {
							NOT = {
								check_variable = { QAT.session_length_increased=1 }
							}
						}
						set_variable = { QAT.session_length = 120 }
						set_variable = { QAT.session_cleanup_length = 125 }
					}

					every_country = {
						limit = { has_country_flag = arab_league_member }
						add_to_array = { QAT.arab_league_total_member_list = THIS.id }
					}
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 50 }
					}
					set_temp_variable = { show = 1 }
					subtract_from_temp_variable = { show = show_usa_congress }
					close_all_windows = yes
					set_variable = { show_usa_congress = show }
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 75 }
					}
					set_temp_variable = { show = 1 }
					set_variable = { french_core_population = 0 }
					for_each_loop = {
						array = core_states
						value = vtest
						index = itest
						var:vtest = {
							add_to_variable = { ROOT.french_core_population = state_population_k }
						}
					}

					set_variable = { Party_pop_RPR = party_popularity@conservative }
					multiply_variable = { Party_pop_RPR = ROOT.french_core_population }
					round_variable = Party_pop_RPR

					set_variable = { Party_pop_RAD = party_popularity@Social_Liberalism }
					multiply_variable = { Party_pop_RAD = ROOT.french_core_population }
					round_variable = Party_pop_RAD

					set_variable = { Party_pop_MRP = party_popularity@Christian_Democratic }
					multiply_variable = { Party_pop_MRP = ROOT.french_core_population }
					round_variable = Party_pop_MRP

					set_variable = { Party_pop_SFIO = party_popularity@socialist }
					multiply_variable = { Party_pop_SFIO = ROOT.french_core_population }
					round_variable = Party_pop_SFIO

					set_variable = { Party_pop_CNIP = party_popularity@Liberal_Conservatism }
					multiply_variable = { Party_pop_CNIP = ROOT.french_core_population }
					round_variable = Party_pop_CNIP

					set_variable = { Party_pop_UDSR = party_popularity@Social_Democratic }
					multiply_variable = { Party_pop_UDSR = ROOT.french_core_population }
					round_variable = Party_pop_UDSR

					set_variable = { Party_pop_PCF = party_popularity@communism }
					multiply_variable = { Party_pop_PCF = ROOT.french_core_population }
					round_variable = Party_pop_PCF
					if = {
						limit = {
							has_country_flag = Troisieme_Force_Coalition
						}
						set_variable = { ROOT.parliamentary_support = party_popularity@socialist }
						add_to_variable = { ROOT.parliamentary_support = party_popularity@Social_Liberalism }
						add_to_variable = { ROOT.parliamentary_support = party_popularity@Christian_Democratic }
						add_to_variable = { ROOT.parliamentary_support = party_popularity@Liberal_Conservatism }
						add_to_variable = { ROOT.parliamentary_support = party_popularity@Social_Democratic }
						multiply_variable = { ROOT.parliamentary_support = 100 }
					}
					if = {
						limit = {
							has_country_flag = Gaullist_Coalition
						}
						set_variable = { ROOT.parliamentary_support = party_popularity@conservative }
						add_to_variable = { ROOT.parliamentary_support = party_popularity@Christian_Democratic }
						add_to_variable = { ROOT.parliamentary_support = party_popularity@Liberal_Conservatism }
						multiply_variable = { ROOT.parliamentary_support = 100 }
					}
					if = {
						limit = {
							has_country_flag = Communist_Coalition
						}
						set_variable = { ROOT.parliamentary_support = party_popularity@communism }
						add_to_variable = { ROOT.parliamentary_support = party_popularity@socialist }
						add_to_variable = { ROOT.parliamentary_support = party_popularity@Social_Democratic }
						multiply_variable = { ROOT.parliamentary_support = 100 }
					}

					subtract_from_temp_variable = { show = show_french_gui }
					close_all_windows = yes
					set_variable = { show_french_gui = show }
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 100 }
					}
					set_variable = { leadership_display = 1 }
					close_all_windows = yes
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 150 }
					}
					set_variable = { diplomacy_display = 1 }
					close_all_windows = yes
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 51 }
					}
					set_variable = { CPC_PB_GUI_VISIBLE = 1 }
					close_all_windows = yes
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 60 }
					}
					set_variable = { KOR_Election_UI = 1 }
					close_all_windows = yes
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 61 }
					}
					set_variable = { RUS_View_Pol = 1 }
					close_all_windows = yes
				}
				if = {
					limit = {
						check_variable = { ROOT.country_politics_list^i = 52 }
					}
					set_temp_variable = { show = 1 }
					subtract_from_temp_variable = { show = show_national_ideas }
					close_all_windows = yes
					set_variable = { show_national_ideas = show }
					clear_array = current_idea_list
					set_variable = {
						last_refresh_date = global.num_days
					}
					for_each_loop = {
						array = global.all_idea_tokens
						if = {
							limit = {
								meta_trigger = {
									text = {
										has_idea = [IDEA_TOKEN]
									}
									IDEA_TOKEN = "[?global.all_idea_tokens^i.GetTokenKey]"
								}
							}
							meta_effect = {
								text = {
									add_to_array = {
										array = ROOT.current_idea_list
										value = [IDEA_TOKEN]
									}
								}
								IDEA_TOKEN = "[?v]"
							}
						}
					}
				}
			}
		}
	}
		
	legislation_menu = {
		context_type = player_context
		parent_window_name = countrypoliticsview
		window_name = "legislation_menu"
		ai_enabled = {
			always = no
		}
		#visible = {
		#	check_variable = { legislation_menu_show = 1 }
		#}
		
		triggers = {
            box_text_click_enabled = {
				always = no
			}
            lgbt_box_text_click_enabled = {
				always = no
			}
            womens_box_text_click_enabled = {
				always = no
			}
            workers_box_text_click_enabled = {
				always = no
			}
            media_box_text_click_enabled = {
				always = no
			}
            minorities_box_text_click_enabled = {
				always = no
			}
            icon_change_religion_policy_button_click_enabled = {
				NOT = {
					OR = {
						has_country_flag = moving_toward_religious_freedom
						has_country_flag = moving_toward_religious_tolerance
						has_country_flag = moving_toward_state_religion
						has_country_flag = moving_toward_religious_education
						has_country_flag = moving_toward_religious_propaganda
						has_country_flag = moving_toward_state_atheism
					}
				}
			}
            icon_change_lgbt_policy_button_click_enabled = {
				NOT = {
					OR = {
						has_country_flag = moving_toward_criminalization
						has_country_flag = moving_toward_persecution
						has_country_flag = moving_toward_tolerance_with_discrimination
						has_country_flag = moving_toward_partial_equality
						has_country_flag = moving_toward_legal_equality
						has_country_flag = moving_toward_positive_action
					}
				}
			}
            icon_change_womens_policy_button_click_enabled = {
				NOT = {
					OR = {
						has_country_flag = moving_toward_patriarchal_society
						has_country_flag = moving_toward_limited_rights
						has_country_flag = moving_toward_partial_womens_equality
						has_country_flag = moving_toward_legal_womens_equality
						has_country_flag = moving_toward_progressive_society
					}
				}
			}
            icon_change_workers_policy_button_click_enabled = {
				NOT = {
					OR = {
						has_country_flag = moving_toward_unions_outlawed
						has_country_flag = moving_toward_no_legal_labor_protection
						has_country_flag = moving_toward_yellow_trade_unions
						has_country_flag = moving_toward_minimal_state_regulations
						has_country_flag = moving_toward_limited_state_regulations
						has_country_flag = moving_toward_well_regulated_workers_rights
						has_country_flag = moving_toward_full_worker_protections

					}
				}
			}
            icon_change_media_policy_button_click_enabled = {
				NOT = {
					OR = {
						has_country_flag = moving_toward_total_state_control_and_propaganda
						has_country_flag = moving_toward_strict_censorship_with_state_run_media
						has_country_flag = moving_toward_state_influence_with_partial_media_freedom
						has_country_flag = moving_toward_government_regulation_with_free_press
						has_country_flag = moving_toward_free_media_with_minimal_regulation

					}
				}
			}
            icon_change_minorities_policy_button_click_enabled = {
				NOT = {
					OR = {
						has_country_flag = moving_toward_state_enforced_discrimination
						has_country_flag = moving_toward_institutional_discrimination
						has_country_flag = moving_toward_limited_minorities_rights
						has_country_flag = moving_toward_equal_rights_on_paper
						has_country_flag = moving_toward_affirmative_action

					}
				}
			}
		}
		effects = {
            box_text_click = {
				if = {
					limit = {
						has_idea = policy_religion_temp_0
					}
					show_ideas_tooltip = policy_religion_temp_0
				}
				if = {
					limit = {
						has_idea = policy_religion_temp_0a
					}
					show_ideas_tooltip = policy_religion_temp_0a
				}
				if = {
					limit = {
						has_idea = policy_religion_temp_1
					}
					show_ideas_tooltip = policy_religion_temp_1
				}
				if = {
					limit = {
						has_idea = policy_religion_temp_2
					}
					show_ideas_tooltip = policy_religion_temp_2
				}
				if = {
					limit = {
						has_idea = policy_religion_temp_3
					}
					show_ideas_tooltip = policy_religion_temp_3
				}
				if = {
					limit = {
						has_idea = policy_religion_temp_3a
					}
					show_ideas_tooltip = policy_religion_temp_3a
				}
			}
			icon_change_religion_policy_button_click = {
				country_event = generic_idea.1 
			}
            lgbt_box_text_click = {
				if = {
					limit = {
						has_idea = policy_saga_temp_0
					}
					show_ideas_tooltip = policy_saga_temp_0
				}
				if = {
					limit = {
						has_idea = policy_saga_temp_1
					}
					show_ideas_tooltip = policy_saga_temp_1
				}
				if = {
					limit = {
						has_idea = policy_saga_temp_2
					}
					show_ideas_tooltip = policy_saga_temp_2
				}
				if = {
					limit = {
						has_idea = policy_saga_temp_3
					}
					show_ideas_tooltip = policy_saga_temp_3
				}
				if = {
					limit = {
						has_idea = policy_saga_temp_4
					}
					show_ideas_tooltip = policy_saga_temp_4
				}
				if = {
					limit = {
						has_idea = policy_saga_temp_4a
					}
					show_ideas_tooltip = policy_saga_temp_4a
				}
			}
			icon_change_lgbt_policy_button_click = {
				country_event = generic_idea.6
			}
            womens_box_text_click = {
				if = {
					limit = {
						has_idea = policy_women_temp_0
					}
					show_ideas_tooltip = policy_women_temp_0
				}
				if = {
					limit = {
						has_idea = policy_women_temp_1
					}
					show_ideas_tooltip = policy_women_temp_1
				}
				if = {
					limit = {
						has_idea = policy_women_temp_2
					}
					show_ideas_tooltip = policy_women_temp_2
				}
				if = {
					limit = {
						has_idea = policy_women_temp_3
					}
					show_ideas_tooltip = policy_women_temp_3
				}
				if = {
					limit = {
						has_idea = policy_women_temp_4
					}
					show_ideas_tooltip = policy_women_temp_4
				}
			}
			icon_change_womens_policy_button_click = {
				country_event = generic_idea.9
			}
            workers_box_text_click = {
				if = {
					limit = {
						has_idea = policy_union_temp_0
					}
					show_ideas_tooltip = policy_union_temp_0
				}
				if = {
					limit = {
						has_idea = policy_union_temp_1
					}
					show_ideas_tooltip = policy_union_temp_1
				}
				if = {
					limit = {
						has_idea = policy_union_temp_2
					}
					show_ideas_tooltip = policy_union_temp_2
				}
				if = {
					limit = {
						has_idea = policy_union_temp_3
					}
					show_ideas_tooltip = policy_union_temp_3
				}
				if = {
					limit = {
						has_idea = policy_union_temp_4
					}
					show_ideas_tooltip = policy_union_temp_4
				}
				if = {
					limit = {
						has_idea = policy_union_temp_5
					}
					show_ideas_tooltip = policy_union_temp_5
				}
				if = {
					limit = {
						has_idea = policy_union_temp_6
					}
					show_ideas_tooltip = policy_union_temp_6
				}
			}
			icon_change_workers_policy_button_click = {
				country_event = generic_idea.13
			}
            media_box_text_click = {
				if = {
					limit = {
						has_idea = policy_media_temp_0
					}
					show_ideas_tooltip = policy_media_temp_0
				}
				if = {
					limit = {
						has_idea = policy_media_temp_1
					}
					show_ideas_tooltip = policy_media_temp_1
				}
				if = {
					limit = {
						has_idea = policy_media_temp_2
					}
					show_ideas_tooltip = policy_media_temp_2
				}
				if = {
					limit = {
						has_idea = policy_media_temp_3
					}
					show_ideas_tooltip = policy_media_temp_3
				}
				if = {
					limit = {
						has_idea = policy_media_temp_3a
					}
					show_ideas_tooltip = policy_media_temp_3a
				}
			}
			icon_change_media_policy_button_click = {
				country_event = generic_idea.17
			}
            minorities_box_text_click = {
				if = {
					limit = {
						has_idea = policy_minorities_temp_0
					}
					show_ideas_tooltip = policy_minorities_temp_0
				}
				if = {
					limit = {
						has_idea = policy_minorities_temp_1
					}
					show_ideas_tooltip = policy_minorities_temp_1
				}
				if = {
					limit = {
						has_idea = policy_minorities_temp_2
					}
					show_ideas_tooltip = policy_minorities_temp_2
				}
				if = {
					limit = {
						has_idea = policy_minorities_temp_3
					}
					show_ideas_tooltip = policy_minorities_temp_3
				}
				if = {
					limit = {
						has_idea = policy_minorities_temp_3a
					}
					show_ideas_tooltip = policy_minorities_temp_3a
				}
			}
			icon_change_minorities_policy_button_click = {
				country_event = generic_idea.19
			}
		}
		properties = {
			progress_bar_acceptance = { 
				frame = ROOT.acceptance_power
			}
			icon_religion_policy_button = {
				image = "[icon_religion_policy]"
			}
			progress_bar_lgbt_acceptance = { 
				frame = ROOT.lgbt_acceptance_power
			}
			icon_lgbt_policy_button = {
				image = "[icon_lgbt_policy]"
			}
			progress_bar_womens_acceptance = { 
				frame = ROOT.womens_acceptance_power
			}
			icon_womens_policy_button = {
				image = "[icon_womens_policy]"
			}
			progress_bar_workers_acceptance = { 
				frame = ROOT.workers_acceptance_power
			}
			icon_workers_policy_button = {
				image = "[icon_workers_policy]"
			}
			progress_bar_media_acceptance = { 
				frame = ROOT.media_acceptance_power
			}
			icon_media_policy_button = {
				image = "[icon_media_policy]"
			}
			progress_bar_minorities_acceptance = { 
				frame = ROOT.minorities_acceptance_power
			}
			icon_minorities_policy_button = {
				image = "[icon_minorities_policy]"
			}
		}
	}
}
